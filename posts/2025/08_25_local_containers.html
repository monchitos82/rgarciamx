<!doctype html>
<html lang="en" color-scheme="light dark">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="./assets/style.css">

  <title>mon's blog ðŸ‘¾</title>
</head>

<body>
  <div id="content">
    <ul class="menu-bar">
      <li class="menu-item" id="posts">
        <a class="dropdown-btn" href="#" title="Posts">
          Posts
        </a>
        <div class="dropdown-content">
          <a class="dropdown-item" href="./posts/2026.html">2026</a>
          <a class="dropdown-item" href="./posts/2025.html">2025</a>
          <a class="dropdown-item" href="./posts/2024.html">2024</a>
        </div>
      </li>
    </ul>
    <br />
  </div>
  <h3>Local containers shenanigans (08/25)</h3>
  <p>During this week I got curious about other distro options. While my <em>Ubuntu</em> installation always felt
    trustworthy, it was still a bit clumsy here and there, so I did what anybody like me, with too much time in their
    hands would do: experiment.</p>
  <p>I started with some <em>VMs</em>, but you don&rsquo;t get to experience things properly in a <em>VM</em>,
    especially figuring out if things <em>&ldquo;just run&rdquo;</em> or you need to put in the hours. So I got some
    live <em>ISOs</em> and started my mess.</p>
  <p>I started with <em>Manjaro</em>. I think it was super neat, the <em>UI</em>, the feel was snappy,
    <code>pacman</code> (or <code>pamac</code> in this context) is very, very complete. I think however it still
    required a lot of pull here, snatch there (especially messing with the <em>BIOS</em>, I understand their point, but
    manufacturers don&rsquo;t) so I didn&rsquo;t delve further, I&rsquo;ll go back to it later though. I tried
    <em>PopOS</em> next, and well, as any <em>Debian</em> based, it was easy going, but the same pains I had with
    <em>Ubuntu</em> were there. Finally I tried <strong><em>Fedora</em></strong>, by the time I installed it, I was
    already tired of this. So I left <em>Fedora</em> as my distro.</p>
  <p>I think this was no bad decision though. My last <em>&ldquo;living only with a Linux machine&rdquo;</em>
    experience, about 8 years ago had <em>CentOS</em> and it wasn&rsquo;t perfect, but was good enough to get me started
    into doing more dev work, more often. <em>Fedora</em> felt similar, except it was way nicer with my hardware, so I
    didn&rsquo;t feel like going back to <em>Ubuntu</em> and setting up a myriad of accounts and settings&hellip; again.
  </p>
  <p>But this hasn&rsquo;t been all <em>&ldquo;peachy&rdquo;</em>, quite the opposite, I forgot about how painful it is
    to work with <em>SELinux</em>. And <em>Fedora</em> was prompt on bringing the experience back. Not the <em>OS</em>
    fault at all, my bad hygiene creating services out of any process worked fine in <em>Debian</em>, but here was
    different, it demanded some discipline from me and well, it took me a few hours and some trial and error and then it
    hit me: I should build these things as containers, especially when they aren&rsquo;t going to be used thoroughly or
    when you will go over this <em>setup-configure-run</em> pain again and again. Since I spent some time in
    <em>podman</em> not long ago, well, I had the commands still fresh in my mind.</p>
  <p>I don&rsquo;t remember all the syntax of everything, but I found that <em>ollama</em> and <em>openweb-ui</em> are
    actually available in containers. Well, time to try this new goal, which by the way, broke my laptop once the Nvidia
    drivers were installed, but we know how things are with Nvidia and <em>Linux</em>. Having fixed it (using those neat
    pages from <em>podman</em> itself), I got these running in no time. And it hit me again after installing
    <strong><em>Qwen</em></strong>: This is as good as we need our generative <em>AI</em> to be. It took a few seconds
    to give me an answer, but this and some reading through <em>API&rsquo;s</em> got me running 30 different services,
    all at the same time, with no memory bottlenecks. Yes, for my use case, which is simple: my own development, my own
    monitoring, my own <em>CI</em>, my own <em>DBs</em>, my own learning, it is more than enough, but that&rsquo;s the
    thing, my use case is already complex, my hardware is quite good for 2020, but 5 years later is good enough as well
    to run an <em>LLM</em> and get me spitting code and configurations as fast as I can. I had broken some
    configurations, had to wrestle with <em>airflow</em> (please somebody tell me what that darn
    <em><strong>Microsoft</strong> directory</em> is?) and figure out ways to edit volumes before mounting them as read
    only, but in the end, all my infra, was replicated beautifully.</p>
  <div align="center">
    <p><sub>é˜¿é‡Œå·´å·´çš„Qwenå¾ˆæ£’!</sub></p>
  </div>
  <p>I know this post is quite shallow since I don&rsquo;t cover many technicalities here and instead dropped names here
    and there, but honestly all the work is already in the docs from most services, I cannot remember many lessons other
    than perhaps <em>flink</em> configurations are better set using <code>-D</code> (dynamic arguments), or that
    <em>alpine</em> is super handy when you screw up a config and plan on editing it within the volume (useful for
    <em>airflow</em> and <em>trino</em> to name a few), or that building <em>Go</em> images is a pain if the
    <code>workdir</code> is not accessed correctly, but the nice thing is that this is a once only kind of pain when
    done right.</p>
  <p>A good one liner for posterity:</p>
  <p><br />
  <pre>
  for CONTAINER in $(podman ps --all --format "{{.Names}}"); do podman inspect ${CONTAINER} | jq '.[0].Config.CreateCommand | join (" ")' | sed -e 's/^"//g' | sed -e 's/$"//g'; done > podman_container_commands
</pre>
  </p>
  <p>A good set of lessons for me:</p>
  <ul>
    <li>Don&rsquo;t use home directories to run services</li>
    <li>Get comfortable using volumes and <code>:z</code> (a lot)</li>
    <li>Get familiar with <code>host.containers.internal</code> and mind those <code>localhost</code> configurations
    </li>
    <li>Read the docs, especially those from <em>podman</em> and <code>Dockerfile</code> (last time I read them was
      2015!)</li>
    <li>There&rsquo;s always a way around <code>docker-compose</code></li>
    <li>Always add volumes for data and prefer variables over configuration files (mind the risk that poses, well,
      secrets exist, right?)</li>
    <li>Don&rsquo;t mess with <em>SELinux</em> configurations when you&rsquo;re missing packages (this one broke my
      boot, my containers, <em>plymouth</em> and <em>systemd</em>)</li>
    <li>Backup <code>/etc</code> from time to time, sometimes it is a big pain to write configurations all over again
    </li>
  </ul>
</body>

</html>